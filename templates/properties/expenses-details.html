{% extends 'dashboard/dashboard-base.html' %}
{% load static %}
{% load template_tags %}

{% block content %}
    <!--
=====================================================
Property Listing Details
=====================================================
-->
    <div class="listing-details-one theme-details-one bg-pink pt-180 lg-pt-150 pb-150 xl-pb-120">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h3 class="property-titlee">Expenses for {{ property }}</h3><br>
                </div>
                <!-- /.media-gallery -->
                <div class="row">
                    <div class="col-xl-8">
                        <div class="bg-white shadow4 border-20">
                            <div class="property-overview p-40">
                                <h3 class="mb-20">Overview</h3>
                                <p class="fs-20 lh-lg">{{ property }} is located
                                    in {{ property.city | default:"N/A" }}, {{ property.country | default:"N/A" }} and it`s bought
                                    for {{ property.property_financial_information.values_list.0.2  | default:"N/A" }} {{ property.property_financial_information.values_list.0.1 }}
                                    on {{ property.bought_date | date:"d-m-Y" | default:"N/A" }}</p>
                                <p>

                                <div class="property-feature-list mt-30">
                                    <ul class="style-none d-flex flex-wrap align-items-center justify-content-center">
                                        <li style="flex-basis: 30%; margin: 10px;">
                                            <p><span class="fs-20 color-dark">Expected expenses: </span></p>
                                            <p><span class="fs-22 color-dark">{{ expenses.expected_expenses }} </span>
                                            </p>
                                        </li>
                                        <li style="flex-basis: 30%; margin: 10px;">
                                            <p><span class="fs-20 color-dark">Actual Expenses: </span></p>

                                            <p><span class="fs-22 color-dark">{{ expenses.actual_expenses }}</span></p>
                                        </li>
                                        <li style="flex-basis: 30%; margin: 10px;">
                                            <p><span class="fs-20 color-dark">Expenses per Sqm: </span></p>

                                            <p><span class="fs-22 color-dark">{{ expenses.expenses_per_sqm }}</span></p>
                                        </li>
                                    </ul>
                                </div>
                                <!-- /.property-feature-list -->
                            </div>
                            <!-- /.property-overview -->
                            <div class="property-feature-accordion border-top p-40">
                                <h3 class="mb-20">Property Expenses</h3>
                                <h5 class="pt-30 pb-25">Renovation Expenses:</h5>
                                <div class="feature-list-two">
                                    <ul class="style-none d-flex flex-wrap justify-content-between">
                                        <li><span>Plumbing Repair: </span> <span
                                                class="fw-500 color-dark">{{ expenses.plumbing_repair_expenses}}</span></li>
                                        <li><span>Electrical Repair: </span> <span
                                                class="fw-500 color-dark">{{ expenses.electrical_repair_expenses }}</span></li>
                                        <li><span>Floors Repair: </span> <span
                                                class="fw-500 color-dark">{{ expenses.floors_repair_expenses }}</span></li>

                                        <li><span>Wall Repair: </span> <span
                                                class="fw-500 color-dark">{{ expenses.walls_repair_expenses}}</span>
                                        </li>
                                        <li><span>Bathroom Repair: </span> <span
                                                class="fw-500 color-dark">{{ expenses.bathroom_repair_expenses }}</span></li>

                                        <li><span>Kitchen Repair: </span> <span
                                                class="fw-500 color-dark">{{ expenses.kitchen_repair_expenses }}</span></li>


                                        <li><span>Windows and Doors Repair: </span> <span
                                                class="fw-500 color-dark">{{ expenses.windows_doors_repair_expenses }}</span></li>

                                        <li><span>Facade/Balcony Repair: </span> <span
                                                class="fw-500 color-dark">{{ expenses.facade_repair_expenses }}</span></li>
                                        <li><span>Roof Repair: </span> <span
                                                class="fw-500 color-dark">{{ expenses.roof_repair_expenses }}</span></li>

                                        <li><span>Other Repair Expenses: </span> <span
                                                class="fw-500 color-dark">{{ expenses.other_repair_expenses }}</span></li>


                                    </ul>
                                </div>
                                <h5 class="pt-30 pb-25">Other Expenses:</h5>
                                <div class="feature-list-two">
                                    <ul class="style-none d-flex flex-wrap justify-content-between">
                                        <li><span>Notary Taxes: </span> <span
                                                class="fw-500 color-dark">{{ expenses.notary_taxes }}</span></li>


                                        <li><span>Municipality Taxes: </span> <span
                                                class="fw-500 color-dark">{{ expenses.municipality_taxes }}</span></li>

                                        <li><span>Utilities: </span> <span
                                                class="fw-500 color-dark">{{ expenses.utilities }}</span></li>


                                        <li><span>Advertising: </span>
                                            <span class="fw-500 color-dark">{{ expenses.advertising }}</span></li>

                                        <li><span>Administrative Fees: </span> <span
                                                class="fw-500 color-dark">{{ expenses.administrative_fees }}</span></li>

                                        <li><span>Insurance: </span> <span
                                                class="fw-500 color-dark">{{ expenses.insurance }}</span></li>
                                        <li><span>Credit Expenses: </span> <span
                                                class="fw-500 color-dark">{{ expenses.credit_interest }}</span>
                                        </li>
                                        <li><span>Other Expenses: </span> <span
                                                class="fw-500 color-dark">{{ expenses.other_expenses }}</span>
                                        </li>
                                        <li><span>Profit Tax: </span> <span
                                                class="fw-500 color-dark">{{ expenses.profit_tax }}</span>
                                        </li>

                                    </ul>
                                </div>
                                <div class="property-feature-accordion border-top mt-40 mb-40">
                                    <h3 class="mt-40 mb-20">Expenses Notes:</h3>
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th scope="col">#</th>
                                            <th scope="col">Date</th>
                                            <th scope="col">Amount</th>
                                            <th scope="col">Expense Type</th>
                                            <th scope="col">Note</th>
                                            <th scope="col">Delete</th>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for note in expenses_notes %}
                                            <tr>
                                                <th scope="row" class="fw-500">{{ forloop.counter }}</th>
                                                <td>{{ note.expense_date }}</td>
                                                <td>{{ note.expense_amount }}</td>
                                                <td>{{ note.expense_type }}</td>
                                                <td>{{ note.notes }}</td>
                                                <td><a href="{% url 'delete_expense' note.id %}"
                                                       class="btn btn-danger btn-sm"
                                                       onclick="return confirm('Are you sure you want to delete this expense?');">
                                                    Delete
                                                </a></td>
                                            </tr>
                                        {% endfor %}
                                        <tr>
                                            <th scope="row" class="fw-500"></th>
                                            <td scope="row" class="fw-500">Total:</td>
                                            <td>{{ expenses.actual_expenses }}</td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>

                                        </tbody>
                                    </table>
                                </div>
                                <!-- /.feature-list-two -->
                            </div>
                            <!-- /.property-feature-accordion -->


                        </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-8 col-xl-4 me-auto ms-auto">
                        <div class="theme-sidebar-one ms-xl-6 lg-mt-80">

                            <div class="tour-schedule bg-white border-20 p-30 mb-40">
                                <h5 class="mb-40">Add Expense</h5>
                                <form class='form-multiline row' action="#" method="post">
                                    {% csrf_token %}
                                    <div class="col-12 mb-3">
                                        {{ form }}
                                        <div class="error-message">{{ form.errors }}</div>
                                    </div>
                                    <div class="col-12 mb-3">
                                        {{ notes_form }}
                                        <div class="error-message">{{ notes_form.errors }}</div>
                                    </div>
                                    <div class="col-12">
                                        <button class="btn-nine text-uppercase rounded-3 w-100 mb-10">Add Expense</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- /.theme-sidebar-one -->
                </div>
            </div>
        </div>
    </div>

    <!-- /.listing-details-one -->


{% endblock %}